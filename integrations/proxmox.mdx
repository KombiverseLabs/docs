---
title: Proxmox integration
description: Manage Proxmox VMs and containers with kombify
---


Use kombify to provision and manage Proxmox Virtual Environment (VE) virtual machines and containers.

## Overview

kombify integrates with Proxmox VE to:
- Provision VMs from templates
- Create LXC containers
- Manage networking and storage
- Deploy services to VMs automatically

## Prerequisites

<CardGroup cols={2}>
  <Card title="Proxmox VE" icon="server">
    Proxmox VE 7.0+ installed
  </Card>
  <Card title="API access" icon="key">
    API token with appropriate permissions
  </Card>
</CardGroup>

## Setup

### Step 1: Create API token

<Steps>
  <Step title="Access Proxmox web UI">
    Navigate to `https://your-proxmox:8006`
  </Step>

  <Step title="Create user for kombify">
    **Datacenter** → **Permissions** → **Users** → **Add**
    
    - User name: `kombify@pve`
    - Realm: `Proxmox VE authentication server`
  </Step>

  <Step title="Assign permissions">
    **Datacenter** → **Permissions** → **Add** → **User Permission**
    
    - Path: `/`
    - User: `kombify@pve`
    - Role: `Administrator` (or custom role)
  </Step>

  <Step title="Generate API token">
    **Datacenter** → **Permissions** → **API Tokens** → **Add**
    
    - User: `kombify@pve`
    - Token ID: `kombify-token`
    - Privilege Separation: **Unchecked**
    
    Save the token ID and secret.
  </Step>
</Steps>

### Step 2: Configure kombify

Add Proxmox credentials to your `kombination.yaml`:

```yaml kombination.yaml
providers:
  proxmox:
    endpoint: https://your-proxmox:8006/api2/json
    token_id: kombify@pve!kombify-token
    token_secret: your-secret-token
    insecure: false  # Set to true for self-signed certs

nodes:
  - name: proxmox-1
    type: proxmox
    role: hypervisor
    connection:
      host: your-proxmox
      node: pve  # Proxmox node name
```

## Provision VMs

### Create VM from template

<Steps>
  <Step title="Prepare template">
    Create a VM template in Proxmox with cloud-init support:
    
    ```bash
    # Download Ubuntu cloud image
    wget https://cloud-images.ubuntu.com/jammy/current/jammy-server-cloudimg-amd64.img
    
    # Create VM
    qm create 9000 --name ubuntu-template --memory 2048 --net0 virtio,bridge=vmbr0
    
    # Import disk
    qm importdisk 9000 jammy-server-cloudimg-amd64.img local-lvm
    
    # Configure VM
    qm set 9000 --scsihw virtio-scsi-pci --scsi0 local-lvm:vm-9000-disk-0
    qm set 9000 --ide2 local-lvm:cloudinit
    qm set 9000 --boot c --bootdisk scsi0
    qm set 9000 --serial0 socket --vga serial0
    
    # Convert to template
    qm template 9000
    ```
  </Step>

  <Step title="Define VM in kombination.yaml">
    ```yaml
    vms:
      - name: app-server-1
        provider: proxmox
        template: ubuntu-template
        specs:
          cores: 4
          memory: 8192
          disk: 50G
        network:
          bridge: vmbr0
          ip: 192.168.1.100/24
          gateway: 192.168.1.1
        cloud_init:
          user: ubuntu
          ssh_keys:
            - ssh-rsa AAAA...
    ```
  </Step>

  <Step title="Deploy">
    ```bash
    kombify apply
    ```
    
    kombify will:
    1. Clone the template
    2. Configure cloud-init
    3. Start the VM
    4. Install the kombify agent
  </Step>
</Steps>

### Create LXC container

```yaml kombination.yaml
containers:
  - name: web-server-1
    provider: proxmox
    template: ubuntu-22.04-standard
    specs:
      cores: 2
      memory: 4096
      disk: 20G
    network:
      bridge: vmbr0
      ip: 192.168.1.101/24
      gateway: 192.168.1.1
```

## Manage networking

### Create VLAN

```yaml kombination.yaml
networks:
  - name: services-vlan
    provider: proxmox
    type: vlan
    vlan_id: 100
    bridge: vmbr0
    subnet: 10.0.100.0/24
    gateway: 10.0.100.1

vms:
  - name: service-vm
    network:
      vlan: services-vlan
      ip: 10.0.100.10/24
```

### Configure firewall

```yaml kombination.yaml
firewall:
  - vm: app-server-1
    rules:
      - action: accept
        type: in
        proto: tcp
        dport: 80,443
        source: 0.0.0.0/0
      
      - action: accept
        type: in
        proto: tcp
        dport: 22
        source: 192.168.1.0/24
```

## Storage management

### Add storage pool

```yaml kombination.yaml
storage:
  - name: vm-storage
    provider: proxmox
    type: lvm-thin
    pool: data
    content: images,rootdir
```

### Attach additional disk

```yaml kombination.yaml
vms:
  - name: database-server
    disks:
      - size: 100G
        storage: vm-storage
        mount: /var/lib/postgresql
```

## Deploy services to VMs

Combine Proxmox provisioning with service deployment:

```yaml kombination.yaml
# Provision VM
vms:
  - name: docker-host
    provider: proxmox
    template: ubuntu-template
    specs:
      cores: 8
      memory: 16384
      disk: 100G

# Deploy services to the VM
services:
  - name: traefik
    node: docker-host
    type: docker
    
  - name: immich
    node: docker-host
    type: docker
```

kombify will:
1. Create the VM
2. Install Docker
3. Deploy the services

## High availability

### Create HA cluster

```yaml kombination.yaml
nodes:
  - name: proxmox-1
    type: proxmox
    role: hypervisor
    cluster: homelab-cluster
    
  - name: proxmox-2
    type: proxmox
    role: hypervisor
    cluster: homelab-cluster
    
  - name: proxmox-3
    type: proxmox
    role: hypervisor
    cluster: homelab-cluster

vms:
  - name: critical-service
    ha:
      enabled: true
      group: homelab-cluster
      priority: 100
```

## Backup and snapshots

### Create snapshots

```yaml kombination.yaml
vms:
  - name: app-server
    snapshots:
      - name: before-update
        description: Snapshot before system update
        include_ram: true
```

### Schedule backups

```yaml kombination.yaml
backup:
  schedule: "0 2 * * *"  # Daily at 2 AM
  retention: 7  # Keep 7 days
  vms:
    - app-server-1
    - database-server
  storage: backup-storage
```

## Monitoring

### VM metrics

kombify automatically collects:
- CPU usage
- Memory usage
- Disk I/O
- Network traffic

Access in the kombify dashboard or via API:

```bash
curl http://localhost:5260/api/v1/vms/app-server-1/metrics
```

## Troubleshooting

<AccordionGroup>
  <Accordion title="API authentication failed">
    Verify your API token:
    
    ```bash
    curl -k -H "Authorization: PVEAPIToken=kombify@pve!kombify-token=YOUR-SECRET" \
      https://your-proxmox:8006/api2/json/version
    ```
  </Accordion>

  <Accordion title="VM creation fails">
    Check Proxmox logs:
    
    ```bash
    # On Proxmox host
    tail -f /var/log/pve/tasks/active
    ```
    
    Common issues:
    - Insufficient storage
    - Template not found
    - Network bridge doesn't exist
  </Accordion>

  <Accordion title="Cloud-init not working">
    Verify cloud-init configuration:
    
    ```bash
    # On the VM
    cloud-init status
    cloud-init analyze show
    ```
  </Accordion>
</AccordionGroup>

## Advanced: OpenTofu integration

kombify generates OpenTofu code for Proxmox:

```hcl
# Generated by kombify
resource "proxmox_vm_qemu" "app_server_1" {
  name        = "app-server-1"
  target_node = "pve"
  clone       = "ubuntu-template"
  
  cores   = 4
  memory  = 8192
  
  disk {
    size    = "50G"
    storage = "local-lvm"
  }
  
  network {
    model  = "virtio"
    bridge = "vmbr0"
  }
}
```

## Next steps

<CardGroup cols={2}>
  <Card title="Coolify integration" icon="ship" href="/integrations/coolify">
    Deploy kombify with Coolify
  </Card>
  <Card title="Zitadel integration" icon="key" href="/integrations/zitadel">
    Set up SSO with Zitadel
  </Card>
  <Card title="Architecture" icon="sitemap" href="/concepts/architecture">
    Understand kombify architecture
  </Card>
  <Card title="Quick start" icon="rocket" href="/quickstart">
    Get started with kombify
  </Card>
</CardGroup>
