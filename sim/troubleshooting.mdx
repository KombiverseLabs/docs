---
title: Sim troubleshooting
description: Common issues and solutions for kombify Sim
sidebarTitle: Troubleshooting
icon: wrench
---


This guide covers common issues you may encounter when using kombify Sim and how to resolve them.

## Quick diagnostics

Run these commands first to gather diagnostic information:

```bash
# Check Sim health
curl http://localhost:5270/health

# Check Docker status
docker ps -a | grep kombisim

# View Sim logs
docker logs kombisim-api --tail 100

# Check resource usage
docker stats --no-stream
```

## Common issues

<Accordion title="Container won't start">
**Symptoms:**
- Node stays in "creating" state
- Error: "Cannot start container"

**Possible causes:**

1. **Docker socket not mounted**
   
   Verify the socket is mounted:
   ```bash
   docker inspect kombisim-api | grep -A5 Mounts
   ```
   
   Fix: Ensure `/var/run/docker.sock` is mounted in your docker-compose.yml

2. **Insufficient resources**
   
   Check available resources:
   ```bash
   docker system df
   docker system info | grep -E "CPUs|Memory"
   ```
   
   Fix: Free up disk space or increase Docker resource limits

3. **Port conflict**
   
   Check if SSH ports are in use:
   ```bash
   netstat -tuln | grep -E "222[0-9]"
   ```
   
   Fix: Stop conflicting services or change SSH port range

**Resolution steps:**
```bash
# Restart Sim
docker compose restart kombisim-api

# If that fails, recreate
docker compose down
docker compose up -d
```
</Accordion>

<Accordion title="SSH connection refused">
**Symptoms:**
- `Connection refused` when SSH-ing to node
- Node shows as "running" but can't connect

**Check 1: Is the node actually running?**
```bash
docker ps | grep <node-id>
```

**Check 2: Is SSH server running inside the container?**
```bash
docker exec <container-id> pgrep sshd
```

If sshd isn't running:
```bash
docker exec <container-id> /usr/sbin/sshd
```

**Check 3: Correct port?**
Get the correct SSH port from the API:
```bash
curl http://localhost:5270/api/v1/nodes/<node-id>/ssh
```

**Check 4: Firewall?**
```bash
# Windows
netsh advfirewall firewall show rule name=all | findstr "2222"

# Linux
sudo iptables -L -n | grep 2222
```

**Fix: Reset node**
```bash
curl -X POST http://localhost:5270/api/v1/nodes/<node-id>/stop
curl -X POST http://localhost:5270/api/v1/nodes/<node-id>/start
```
</Accordion>

<Accordion title="API returns 500 errors">
**Symptoms:**
- API calls fail with 500 status
- Dashboard shows errors

**Check logs:**
```bash
docker logs kombisim-api --tail 200 2>&1 | grep -i error
```

**Common causes:**

1. **Database corruption**
   ```bash
   # Check database file
   ls -la data/kombisim.db
   
   # If corrupted, reset (loses all data)
   rm data/kombisim.db
   docker compose restart kombisim-api
   ```

2. **Docker API issues**
   ```bash
   # Test Docker API access
   docker exec kombisim-api curl --unix-socket /var/run/docker.sock http://localhost/version
   ```

3. **Memory exhaustion**
   ```bash
   docker stats kombisim-api --no-stream
   # Check Memory % - if near 100%, increase limits
   ```
</Accordion>

<Accordion title="Nodes disappear after restart">
**Symptoms:**
- Simulations empty after Sim restart
- Nodes gone but containers still exist

**Cause:** Database wasn't persisted properly.

**Fix: Ensure data volume is configured:**
```yaml
# docker-compose.yml
services:
  kombisim-api:
    volumes:
      - ./data:/app/data  # Persist database
      - /var/run/docker.sock:/var/run/docker.sock
```

**Recovery (if containers exist):**
```bash
# List orphan containers
docker ps -a | grep kombisim_node

# Clean up
docker rm -f $(docker ps -aq -f name=kombisim_node)
```
</Accordion>

<Accordion title="High CPU/memory usage">
**Symptoms:**
- Host system slow
- Docker using excessive resources

**Identify resource-heavy nodes:**
```bash
docker stats --no-stream
```

**Reduce resource usage:**

1. Stop unused simulations:
   ```bash
   curl -X POST http://localhost:5270/api/v1/simulations/<id>/stop
   ```

2. Reduce node resources in simulation config:
   ```json
   {
     "resources": {
       "vcpus": 1,
       "memory_mb": 512
     }
   }
   ```

3. Use minimal template:
   ```bash
   curl -X POST http://localhost:5270/api/v1/templates/single-local/apply
   ```
</Accordion>

<Accordion title="Network latency simulation not working">
**Symptoms:**
- `POST /nodes/{id}/latency` succeeds but no effect
- Ping times unchanged

**Cause:** The container doesn't have NET_ADMIN capability.

**Fix:** Recreate simulation with proper config:
```json
{
  "nodes": [{
    "name": "test-node",
    "capabilities": ["NET_ADMIN"]
  }]
}
```

**Verify tc rules inside container:**
```bash
docker exec <container-id> tc qdisc show
```
</Accordion>

<Accordion title="Dashboard won't load">
**Symptoms:**
- Blank page or spinner
- Console errors

**Check frontend service:**
```bash
curl http://localhost:5271/
```

**If using Docker Compose with separate frontend:**
```bash
docker logs kombisim-ui --tail 100
```

**Common fixes:**

1. Clear browser cache
2. Check CORS settings if API is on different domain
3. Verify API URL in frontend config

**Reset frontend:**
```bash
docker compose restart kombisim-ui
```
</Accordion>

## Engine-specific issues

<Tabs>
  <Tab title="Container (Docker)">
    ### Docker-specific issues
    
    **Permission denied on socket:**
    ```bash
    # Check socket permissions
    ls -la /var/run/docker.sock
    
    # Fix: Add user to docker group
    sudo usermod -aG docker $USER
    newgrp docker
    ```
    
    **Out of disk space:**
    ```bash
    # Clean up Docker
    docker system prune -a --volumes
    ```
    
    **Network conflicts:**
    ```bash
    # List networks
    docker network ls | grep kombisim
    
    # Remove conflicting network
    docker network rm <network-id>
    ```
  </Tab>
  <Tab title="Incus">
    ### Incus-specific issues
    
    **Incus not found:**
    ```bash
    # Check Incus installation
    incus version
    
    # Initialize Incus
    incus admin init
    ```
    
    **Image not available:**
    ```bash
    # List available images
    incus image list images:
    
    # Pull specific image
    incus image copy images:ubuntu/24.04 local:
    ```
    
    **Permission issues:**
    ```bash
    # Check user in incus-admin group
    groups | grep incus-admin
    ```
  </Tab>
  <Tab title="QEMU">
    ### QEMU-specific issues
    
    **QEMU backend not responding:**
    ```bash
    # Check backend URL
    curl http://localhost:8080/health
    
    # Verify KOMBISIM_ENGINE_ENDPOINT
    echo $KOMBISIM_ENGINE_ENDPOINT
    ```
    
    **VM creation fails:**
    - Check libvirt/KVM is installed
    - Verify virtualization is enabled in BIOS
    - Check libvirt logs: `/var/log/libvirt/qemu/`
  </Tab>
  <Tab title="Azure">
    ### Azure-specific issues
    
    **Authentication failed:**
    ```bash
    # Verify Azure credentials
    az account show
    
    # Re-login
    az login
    ```
    
    **Resource group missing:**
    ```bash
    # Create resource group
    az group create --name kombisim-rg --location westeurope
    ```
    
    **Quota exceeded:**
    - Check Azure portal for quota limits
    - Request quota increase or use different VM size
  </Tab>
</Tabs>

## Log analysis

### Log levels

Set log level in environment:
```bash
KOMBISIM_LOG_LEVEL=debug docker compose up
```

| Level | Description |
|-------|-------------|
| `error` | Errors only |
| `warn` | Warnings and errors |
| `info` | Standard logging (default) |
| `debug` | Detailed debugging |

### Key log patterns

```bash
# Find all errors
docker logs kombisim-api 2>&1 | grep -i error

# Find node lifecycle events
docker logs kombisim-api 2>&1 | grep -E "node|container"

# Find API requests
docker logs kombisim-api 2>&1 | grep -E "POST|GET|DELETE"
```

## Getting help

If you can't resolve your issue:

1. **Gather diagnostics:**
   ```bash
   docker logs kombisim-api > sim-logs.txt 2>&1
   curl http://localhost:5270/health > health.json
   docker ps -a > containers.txt
   ```

2. **Check GitHub issues:**
   [github.com/kombify/sim/issues](https://github.com/kombify/sim/issues)

3. **Ask on Discord:**
   [discord.gg/kombify](https://discord.gg/kombify) â€” #sim-support channel

4. **Report a bug:**
   Include logs, health output, and steps to reproduce.
