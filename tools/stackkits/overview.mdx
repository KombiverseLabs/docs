---
title: StackKits overview
description: Declarative infrastructure blueprints with CUE validation and OpenTofu execution
---

# StackKits

StackKits are **declarative infrastructure blueprints** that combine CUE validation with OpenTofu execution. They provide battle-tested configurations for common homelab scenarios.

<CardGroup cols={2}>
  <Card
    title="Quick start"
    icon="rocket"
    href="/tools/stackkits/quickstart"
  >
    Deploy your first StackKit
  </Card>
  <Card
    title="Available StackKits"
    icon="boxes-stacked"
    href="/tools/stackkits/available-kits"
  >
    Browse infrastructure blueprints
  </Card>
  <Card
    title="Create custom StackKits"
    icon="hammer"
    href="/tools/stackkits/creating-stackkits"
  >
    Build your own templates
  </Card>
  <Card
    title="CLI reference"
    icon="terminal"
    href="/tools/stackkits/cli-reference"
  >
    Command-line tool documentation
  </Card>
</CardGroup>

## What is a StackKit?

A StackKit is a complete infrastructure template that includes:

- **CUE schemas** for validation
- **OpenTofu templates** for provisioning
- **Service definitions** for applications
- **OS variants** for different distributions
- **Default configurations** for quick starts

Think of StackKits as "infrastructure recipes" - battle-tested configurations for common homelab scenarios.

## Key features

<AccordionGroup>
  <Accordion title="Validated configuration" icon="shield-check">
    CUE schemas catch errors before deployment:
    
    ```cue
    #BaseHomelabKit: {
        nodes: [...#Node]
        nodes: {
            // At least one main node required
            [_]: type: "main" | "worker"
        }
        
        services: [...#Service]
        services: {
            // Traefik is required
            [_]: name: "traefik" | "dokploy" | "portainer"
        }
    }
    ```
  </Accordion>

  <Accordion title="IaC-first architecture" icon="cube">
    OpenTofu as execution engine, not custom scripts:
    
    - Full Terraform provider ecosystem
    - State management
    - Plan and apply workflow
    - Drift detection (Advanced mode)
  </Accordion>

  <Accordion title="Multi-OS support" icon="server">
    Ubuntu, Debian, and more via variants:
    
    ```yaml
    variant: os/ubuntu-24  # Ubuntu 24.04
    variant: os/debian-12  # Debian 12
    ```
  </Accordion>

  <Accordion title="Standalone or integrated" icon="plug">
    Use via CLI or with KombiStack Web UI:
    
    **Standalone:**
    ```bash
    stackkit init base-homelab
    stackkit apply
    ```
    
    **Integrated:**
    ```yaml
    # kombination.yaml
    kit: base-homelab
    ```
  </Accordion>
</AccordionGroup>

## Available StackKits

| StackKit | Description | Nodes | Status |
|----------|-------------|-------|--------|
| **base-homelab** | Single server, local only | 1 | âœ… Available |
| **modern-homelab** | Multi-node Docker + Dokploy | 2+ | ğŸš§ Schema Only |
| **ha-homelab** | Docker Swarm HA Cluster | 3+ | ğŸš§ Schema Only |

See [Available StackKits](/tools/stackkits/available-kits) for detailed information.

## 3-layer architecture

StackKits use a strict 3-layer architecture for maximum reusability:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  LAYER 3: STACKKITS (stackkits/)                            â”‚
â”‚  Use-case specific configurations with services             â”‚
â”‚  â€¢ base-homelab: Single-node Docker + Dokploy               â”‚
â”‚  â€¢ modern-homelab: Multi-node Docker + Dokploy              â”‚
â”‚  â€¢ ha-homelab: Docker Swarm HA (3+ Nodes)                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  LAYER 2: PLATFORMS (platforms/)                            â”‚
â”‚  Container orchestration layer                              â”‚
â”‚  â€¢ docker/: Docker + Traefik + Swarm                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  LAYER 1: CORE (base/)                                      â”‚
â”‚  Shared foundation applied to ALL deployments               â”‚
â”‚  â€¢ Bootstrap, Security, Network, Observability              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Layer 1: Core

Shared foundation applied to **all** deployments:

```cue
package base

#BaseStackKit: {
    // Security hardening
    security: {
        ssh: {
            disable_password_auth: true
            port: *22 | int
        }
        firewall: {
            enabled: true
            default_policy: "deny"
        }
    }
    
    // Network configuration
    network: {
        ipv4: bool
        ipv6: *false | bool
    }
}
```

### Layer 2: Platforms

Container orchestration layer:

```cue
package docker

#DockerPlatform: {
    runtime: "docker"
    version: string | *"24.0"
    
    services: {
        traefik: #TraefikService
    }
}
```

### Layer 3: StackKits

Use-case specific configurations:

```cue
package base_homelab

import "github.com/kombihq/stackkits/base"
import "github.com/kombihq/stackkits/platforms/docker"

#BaseHomelabKit: base.#BaseStackKit & docker.#DockerPlatform & {
    metadata: {
        name: "base-homelab"
        version: "1.0.0"
    }
    
    nodes: [#MainNode]
    services: [#TraefikService, #DokployService]
}
```

## Deployment modes

<Tabs>
  <Tab title="Simple mode">
    **When:** â‰¤3 workers, straightforward setup
    
    **How:** Single OpenTofu file, direct `tofu apply`
    
    ```hcl
    terraform {
      required_providers {
        docker = {
          source  = "kreuzwerker/docker"
          version = "~> 3.0"
        }
      }
    }
    
    resource "docker_container" "traefik" {
      name  = "traefik"
      image = "traefik:3.0"
      # ...
    }
    ```
    
    **Pros:** Simple, fast, easy to debug
  </Tab>

  <Tab title="Advanced mode">
    **When:** >3 workers, complex multi-node setups
    
    **How:** Terramate-orchestrated stacks with drift detection
    
    ```hcl
    globals {
      stack_name = tm.stack.name
      environment = "production"
    }
    
    stack {
      name        = "network"
      description = "Network infrastructure"
      after       = []
    }
    ```
    
    **Pros:** Drift detection, parallel execution, change sets
  </Tab>
</Tabs>

## StackKit structure

Each StackKit contains:

```
base-homelab/
â”œâ”€â”€ stackkit.yaml           # Metadata
â”œâ”€â”€ stackfile.cue           # CUE schema
â”œâ”€â”€ services.cue            # Service definitions
â”œâ”€â”€ default-spec.yaml       # CLI template
â”œâ”€â”€ templates/
â”‚   â”œâ”€â”€ simple/             # OpenTofu-only
â”‚   â”‚   â””â”€â”€ main.tf
â”‚   â””â”€â”€ advanced/           # Terramate + OpenTofu
â”‚       â”œâ”€â”€ globals.tm.hcl
â”‚       â””â”€â”€ stacks/
â””â”€â”€ variants/
    â”œâ”€â”€ os/                 # Ubuntu, Debian
    â””â”€â”€ compute/            # High, standard, low
```

## Usage

### Standalone CLI

```bash
# Initialize from StackKit
stackkit init base-homelab

# Check prerequisites
stackkit prepare

# Generate OpenTofu files
stackkit generate

# Preview changes
stackkit plan

# Apply infrastructure
stackkit apply
```

### With KombiStack

```yaml
# kombination.yaml
version: "1.0"
name: my-homelab
kit: base-homelab
variant: os/ubuntu-24

nodes:
  - name: server-1
    type: main
    ssh:
      host: 192.168.1.100
      user: admin

services:
  - name: traefik
  - name: dokploy
```

KombiStack automatically:
1. Validates via Unifier Pipeline
2. Resolves StackKit (`base-homelab`)
3. Applies OS variant (auto-detect)
4. Generates `stack-spec.yaml`
5. Provisions via OpenTofu

## Variants

StackKits support variants for different operating systems and compute tiers:

### OS variants

```yaml
# Ubuntu 24.04
variant: os/ubuntu-24

# Debian 12
variant: os/debian-12
```

### Compute variants

```yaml
# High performance
variant: compute/high

# Standard
variant: compute/standard

# Low resource
variant: compute/low
```

## Tech stack

| Component | Technology | Purpose |
|-----------|------------|---------|
| **Validation** | CUE 0.9+ | Type-safe configuration |
| **Execution** | OpenTofu 1.6+ | Infrastructure provisioning |
| **Orchestration** | Terramate 0.6+ | Multi-stack management (optional) |
| **CLI** | Go 1.24+ | Command-line tool |

## License

MIT License - see [LICENSE](https://github.com/KombiverseLabs/StackKits/blob/main/LICENSE)

## Next steps

<CardGroup cols={2}>
  <Card
    title="Quick start guide"
    icon="play"
    href="/tools/stackkits/quickstart"
  >
    Deploy your first StackKit
  </Card>
  <Card
    title="Available StackKits"
    icon="boxes-stacked"
    href="/tools/stackkits/available-kits"
  >
    Browse infrastructure blueprints
  </Card>
  <Card
    title="Create custom StackKits"
    icon="hammer"
    href="/tools/stackkits/creating-stackkits"
  >
    Build your own templates
  </Card>
  <Card
    title="CLI reference"
    icon="terminal"
    href="/tools/stackkits/cli-reference"
  >
    Command-line documentation
  </Card>
</CardGroup>
