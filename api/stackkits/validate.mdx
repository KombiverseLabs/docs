---
title: Validate endpoint
description: Validate StackKit configurations against schemas
---

# Validate configuration

Validates a configuration against a StackKit's schema before deployment.

## Endpoint

```
POST /api/v1/stackkits/validate
```

## Request

### Headers

| Header | Required | Description |
|--------|----------|-------------|
| `Content-Type` | Yes | Must be `application/json` |
| `Authorization` | No | Required for Sphere API |

### Body

<ParamField path="stackkit" type="string" required>
  The StackKit ID to validate against (e.g., `base-homelab`)
</ParamField>

<ParamField path="version" type="string">
  Specific version to validate against. Defaults to latest.
</ParamField>

<ParamField path="config" type="object" required>
  The configuration object to validate
</ParamField>

<ParamField path="strict" type="boolean">
  Enable strict mode (fail on warnings). Default: `false`
</ParamField>

### Example request

```bash
curl -X POST http://localhost:8080/api/v1/stackkits/validate \
  -H "Content-Type: application/json" \
  -d '{
    "stackkit": "base-homelab",
    "version": "1.2.0",
    "config": {
      "domain": "home.example.com",
      "timezone": "Europe/Berlin",
      "services": ["traefik", "portainer", "homepage"],
      "network": {
        "subnet": "172.20.0.0/24",
        "gateway": "172.20.0.1"
      },
      "storage": {
        "path": "/data",
        "backup_enabled": true
      }
    }
  }'
```

## Response

### Success (valid configuration)

```json
{
  "valid": true,
  "stackkit": "base-homelab",
  "version": "1.2.0",
  "validated_at": "2026-01-26T10:00:00Z",
  "warnings": [
    {
      "path": "storage.backup_enabled",
      "code": "BACKUP_DESTINATION_MISSING",
      "message": "Backup enabled but no destination configured"
    }
  ],
  "info": {
    "services_count": 3,
    "estimated_resources": {
      "cpu": "2 cores",
      "memory": "2Gi",
      "disk": "10Gi"
    }
  }
}
```

### Validation failure

```json
{
  "valid": false,
  "stackkit": "base-homelab",
  "version": "1.2.0",
  "errors": [
    {
      "path": "domain",
      "code": "REQUIRED",
      "message": "Field 'domain' is required"
    },
    {
      "path": "network.subnet",
      "code": "INVALID_CIDR",
      "message": "Invalid CIDR notation: '172.20.0/24'"
    },
    {
      "path": "services[2]",
      "code": "UNKNOWN_SERVICE",
      "message": "Unknown service 'foobar'. Did you mean 'portainer'?"
    }
  ],
  "warnings": []
}
```

## Response fields

<ResponseField name="valid" type="boolean">
  Whether the configuration is valid
</ResponseField>

<ResponseField name="stackkit" type="string">
  The StackKit ID that was validated against
</ResponseField>

<ResponseField name="version" type="string">
  The version used for validation
</ResponseField>

<ResponseField name="errors" type="array">
  Validation errors (only present if `valid: false`)
</ResponseField>

<ResponseField name="warnings" type="array">
  Non-blocking warnings about the configuration
</ResponseField>

<ResponseField name="info" type="object">
  Additional information about the validated config
</ResponseField>

## Error codes

| Code | Description |
|------|-------------|
| `REQUIRED` | Required field is missing |
| `INVALID_TYPE` | Field has wrong data type |
| `INVALID_FORMAT` | Field format is invalid (e.g., email, URL) |
| `INVALID_CIDR` | Invalid CIDR notation |
| `UNKNOWN_SERVICE` | Service not available in StackKit |
| `RESERVED_RANGE` | IP range conflicts with reserved ranges |
| `DUPLICATE_PORT` | Port already used by another service |
| `CONSTRAINT_VIOLATION` | Value violates a constraint (min, max, etc.) |

## Strict mode

With `strict: true`, warnings are treated as errors:

```bash
curl -X POST http://localhost:8080/api/v1/stackkits/validate \
  -H "Content-Type: application/json" \
  -d '{
    "stackkit": "base-homelab",
    "config": {...},
    "strict": true
  }'
```

## Common patterns

<Accordion title="Validate before deployment" icon="check">

```bash
#!/bin/bash
set -e

# Validate
RESULT=$(curl -s -X POST http://localhost:8080/api/v1/stackkits/validate \
  -H "Content-Type: application/json" \
  -d @kombination.yaml)

if [ "$(echo $RESULT | jq -r .valid)" != "true" ]; then
  echo "❌ Validation failed:"
  echo $RESULT | jq -r '.errors[] | "  - \(.path): \(.message)"'
  exit 1
fi

echo "✅ Configuration valid"

# Show warnings
WARNINGS=$(echo $RESULT | jq -r '.warnings | length')
if [ "$WARNINGS" -gt 0 ]; then
  echo "⚠️  Warnings:"
  echo $RESULT | jq -r '.warnings[] | "  - \(.path): \(.message)"'
fi

# Proceed with deployment
kombify deploy
```

</Accordion>

<Accordion title="Validate multiple configs" icon="list">

```bash
# Validate all kombination files in a directory
for file in configs/*.yaml; do
  echo "Validating $file..."
  
  curl -s -X POST http://localhost:8080/api/v1/stackkits/validate \
    -H "Content-Type: application/json" \
    -d @"$file" | jq -e '.valid == true' || echo "FAILED: $file"
done
```

</Accordion>

## Related

<CardGroup cols={2}>
  <Card title="Generate endpoint" icon="wand-magic-sparkles" href="/api/stackkits/generate">
    Generate infrastructure code
  </Card>
  <Card title="StackKits overview" icon="boxes-stacked" href="/api/stackkits/overview">
    StackKits API overview
  </Card>
</CardGroup>
