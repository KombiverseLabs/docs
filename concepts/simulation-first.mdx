---
title: Simulation first
description: Test infrastructure configurations before deploying to real hardware with KombiSim
---


kombify Cloud follows a **simulation-first** philosophy: test your infrastructure configurations in a safe, isolated environment before deploying to real hardware.

## Why simulate?

<CardGroup cols={2}>
  <Card title="Catch errors early" icon="bug">
    Identify configuration issues before they affect production
  </Card>
  <Card title="Zero risk" icon="shield-check">
    Test destructive changes without impacting real systems
  </Card>
  <Card title="Fast iteration" icon="forward-fast">
    Spin up and tear down environments in seconds
  </Card>
  <Card title="Cost effective" icon="dollar-sign">
    No cloud costs for testing and development
  </Card>
</CardGroup>

## How KombiSim works

KombiSim creates lightweight Docker-based "VMs" that simulate your infrastructure:

```
┌─────────────────────────────────────────────────────────────┐
│                      KombiSim Engine                         │
├─────────────────────────────────────────────────────────────┤
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐     │
│  │   Web UI    │───▶│  REST API   │───▶│   Docker    │     │
│  │ :5271       │    │   :5270     │    │   Engine    │     │
│  └─────────────┘    └─────────────┘    └─────────────┘     │
│                                                             │
│  ┌─────────────────────────────────────────────────────────┤
│  │  Port Range: 2222-2322 (SSH to containers)              │
│  └─────────────────────────────────────────────────────────┘
└─────────────────────────────────────────────────────────────┘
```

### Simulation nodes

Each simulated node is a Docker container with:

- **Real SSH access** on ports 2222-2322
- **Persistent storage** via Docker volumes
- **Network isolation** with custom Docker networks
- **Resource limits** to simulate different hardware tiers

## Workflow

<Steps>
  <Step title="Create simulation">
    Define your infrastructure in KombiSim:
    
    ```bash
    curl -X POST http://localhost:5270/api/v1/simulations \
      -H "Content-Type: application/json" \
      -d '{
        "name": "my-homelab-test",
        "nodes": [
          {"name": "vps-web", "location": "vps"},
          {"name": "local-db", "location": "local"}
        ]
      }'
    ```
  </Step>

  <Step title="Start nodes">
    ```bash
    curl -X POST http://localhost:5270/api/v1/simulations/{id}/start
    ```
    
    KombiSim creates Docker containers and assigns SSH ports.
  </Step>

  <Step title="Test configuration">
    SSH into simulated nodes and test your setup:
    
    ```bash
    # Get SSH details
    curl http://localhost:5270/api/v1/nodes/{id}/ssh
    
    # SSH into node
    ssh -p 2222 root@localhost
    # Password: kombisim
    ```
  </Step>

  <Step title="Deploy with KombiStack">
    Once validated, deploy to real infrastructure:
    
    ```bash
    # Export simulation config
    curl http://localhost:5270/api/v1/simulations/{id}/export > kombination.yaml
    
    # Deploy to real hardware
    kombistack apply kombination.yaml
    ```
  </Step>
</Steps>

## Pre-built templates

KombiSim includes 6 templates for common scenarios:

<Tabs>
  <Tab title="Homelab basic">
    **2 nodes:** Web server + Database
    
    ```json
    {
      "name": "homelab-basic",
      "category": "homelab",
      "nodes": [
        {"name": "web-server", "location": "local"},
        {"name": "database", "location": "local"}
      ]
    }
    ```
    
    **Use case:** Simple web application with database
  </Tab>

  <Tab title="Homelab advanced">
    **5 nodes:** Proxy, apps, database, storage, monitoring
    
    ```json
    {
      "name": "homelab-advanced",
      "category": "homelab",
      "nodes": [
        {"name": "proxy", "location": "local"},
        {"name": "app-1", "location": "local"},
        {"name": "app-2", "location": "local"},
        {"name": "database", "location": "local"},
        {"name": "storage", "location": "local"}
      ]
    }
    ```
    
    **Use case:** Production-grade homelab
  </Tab>

  <Tab title="Hybrid setup">
    **5 nodes:** VPS + Local combined
    
    ```json
    {
      "name": "hybrid-setup",
      "category": "homelab",
      "nodes": [
        {"name": "vps-web", "location": "vps"},
        {"name": "vps-api", "location": "vps"},
        {"name": "local-db", "location": "local"},
        {"name": "local-storage", "location": "local"},
        {"name": "local-backup", "location": "local"}
      ]
    }
    ```
    
    **Use case:** Public services on VPS, data at home
  </Tab>

  <Tab title="HA setup">
    **5 nodes:** Load balancer + HA cluster
    
    ```json
    {
      "name": "ha-setup",
      "category": "homelab",
      "nodes": [
        {"name": "lb-1", "location": "local"},
        {"name": "app-1", "location": "local"},
        {"name": "app-2", "location": "local"},
        {"name": "db-primary", "location": "local"},
        {"name": "db-replica", "location": "local"}
      ]
    }
    ```
    
    **Use case:** High availability testing
  </Tab>
</Tabs>

## Integration with KombiStack

KombiStack can automatically use KombiSim for validation:

```yaml kombistack.yaml
simulation:
  enabled: true
  endpoint: "http://localhost:5270"
  auto_validate: true
  
validation:
  simulate_before_deploy: true
  simulation_timeout: 300s
```

### Automatic simulation workflow

When `simulate_before_deploy` is enabled:

<Steps>
  <Step title="Create simulation">
    KombiStack sends your `kombination.yaml` to KombiSim
  </Step>

  <Step title="Provision simulated nodes">
    KombiSim creates Docker containers matching your spec
  </Step>

  <Step title="Run pre-checks">
    KombiStack validates:
    - SSH connectivity
    - Required packages
    - Network configuration
    - Service dependencies
  </Step>

  <Step title="Deploy to simulation">
    Full deployment to simulated infrastructure
  </Step>

  <Step title="Validation results">
    If successful, proceed to real deployment
    
    If failed, return errors and logs
  </Step>
</Steps>

## Testing scenarios

### 1. Service dependencies

Test that services start in the correct order:

```yaml
services:
  - name: postgres
    type: database
  
  - name: web-app
    type: application
    depends_on: [postgres]
```

**Simulation validates:**
- PostgreSQL starts first
- Web app waits for database
- Connection strings are correct

### 2. Network configuration

Test firewall rules and port mappings:

```yaml
services:
  - name: traefik
    firewall:
      allow:
        - port: 80
        - port: 443
```

**Simulation validates:**
- Ports are accessible
- Firewall rules are applied
- SSL certificates work

### 3. Resource constraints

Test with limited resources:

```yaml
nodes:
  - name: low-spec-server
    resources:
      cpu: 2
      memory: 4GB
```

**Simulation validates:**
- Services run within constraints
- No OOM errors
- Performance is acceptable

## Best practices

<AccordionGroup>
  <Accordion title="Always simulate complex changes" icon="flask">
    Before making significant infrastructure changes:
    
    1. Create a simulation matching your current setup
    2. Apply the changes to the simulation
    3. Validate everything works
    4. Deploy to production
  </Accordion>

  <Accordion title="Use templates as starting points" icon="file-code">
    Start with a pre-built template and customize:
    
    ```bash
    # Apply template
    curl -X POST http://localhost:5270/api/v1/templates/homelab-basic/apply \
      -d '{"simulation_name": "my-test", "auto_start": true}'
    
    # Customize nodes
    curl -X PATCH http://localhost:5270/api/v1/nodes/{id} \
      -d '{"resources": {"memory": "8GB"}}'
    ```
  </Accordion>

  <Accordion title="Clean up simulations" icon="trash">
    Delete simulations after testing to free resources:
    
    ```bash
    curl -X DELETE http://localhost:5270/api/v1/simulations/{id}
    ```
  </Accordion>

  <Accordion title="Export validated configs" icon="download">
    Save working configurations for reuse:
    
    ```bash
    curl http://localhost:5270/api/v1/simulations/{id}/export > validated-config.yaml
    ```
  </Accordion>
</AccordionGroup>

## Limitations

<Warning>
  KombiSim is for **testing and validation**, not production workloads.
</Warning>

**What KombiSim simulates:**
- ✅ Service deployment and configuration
- ✅ Network connectivity and firewall rules
- ✅ SSH access and authentication
- ✅ Basic resource constraints

**What KombiSim does NOT simulate:**
- ❌ Real hardware performance
- ❌ Actual network latency
- ❌ Physical hardware failures
- ❌ Production-scale load

## Next steps

<CardGroup cols={2}>
  <Card
    title="KombiSim quickstart"
    icon="rocket"
    href="/tools/kombisim/quickstart"
  >
    Get started with simulation
  </Card>
  <Card
    title="KombiSim templates"
    icon="file-code"
    href="/tools/kombisim/templates"
  >
    Explore pre-built templates
  </Card>
  <Card
    title="KombiSim API reference"
    icon="code"
    href="/api/kombisim/overview"
  >
    Full API documentation
  </Card>
  <Card
    title="KombiStack integration"
    icon="layer-group"
    href="/tools/kombistack/configuration"
  >
    Configure automatic simulation
  </Card>
</CardGroup>
